{"greeting": "Greetings from The On-Line Encyclopedia of Integer Sequences! http://oeis.org/", "query": "id:A008971", "count": 1, "start": 0, "results": [{"number": 8971, "data": "1,1,1,1,1,5,1,18,5,1,58,61,1,179,479,61,1,543,3111,1385,1,1636,18270,19028,1385,1,4916,101166,206276,50521,1,14757,540242,1949762,1073517,50521,1,44281,2819266,16889786,17460701,2702765,1,132854,14494859", "name": "Triangle read by rows: T(n,k) is the number of permutations of [n] with k increasing runs of length at least 2.", "comment": ["Row n has 1+floor(n/2) terms.", "T(n,k) is also the number of permutations of [n] with k \"exterior peaks\" where we count peaks in the usual way, but add a peak at the beginning if the permutation begins with a descent, e.g. 213 has one exterior peak. T(3,1) = 5 since all permutations of [3] have an exterior peak except 123. This is also the definition for peaks of signed permutations, where we assume that a signed permutation always begins with a zero. - _Kyle Petersen_, Jan 14 2005", "From _Petros Hadjicostas_, Aug 09 2019: (Start)", "In their book, David and Barton (1962) use the notation T_{N,v*}^* for this array, where N is the length of the permutation and v* is the so-called \"number of runs up\" in the permutation. In modern terminology, a \"run up\" in a permutation is an increasing run of length >= 2. See their discussion on p. 154 of their book and see p. 163 for the definition of T_{N,v*}^*.", "They do not consider as \"runs up\" single elements b_i in a permutation b = (b_1, b_2, ..., b_n) even if they satisfy b_{i-1} > b_i > b_{i+1} (with b_{n-1} > b_n when i = n and b_1 > b_2 when i = 1). (The command Runs[b] for permutation b in Mathematica, using the package Combinatorica`, will generate not only the \"runs up\" of b but also the single elements in the permutation b that satisfy one of the above inequalities. For example, Runs[{3,2,1}] gives the set of runs {{3}, {2}, {1}}, none of which is a \"run up\".)", "So, here n = N and k = v*. On p. 163 of their book they give the recurrence shown below in the FORMULA section from Charalambides' (2002) book: T(n+1, k) = (2*k + 1) * T(n,k) + (n - 2*k + 2) * T(n, k-1) for n >= 0 and 1 <= k <= floor(n/2) + 1. The values of T_{N,v*}^* = T(n, k) appear in Table 10.5 (p. 163) of their book.", "Since the complement of a permutation (b_1, b_2, ..., b_n) is (n+1-b_1, n+1-b_2, ..., n+1-b_n), it is clear that the current array T(n, k) is also the number of permutations of [n] with k decreasing runs of length >= 2 (i.e., the number of permutations of [n] with k \"runs down\" according to David and Barton (1962)).", "Note that the number of permutations of [n] with k runs of length >= 2 that are either increasing or decreasing (i.e., the number of permutations of [n] that contain k \"runs up\" and \"runs down\" in total) is given by array A059427. One half of array A059427 is given in Table 10.4 (p. 159) in David and Barton (1962)--see also array A008970.", "A run that is either a \"run up\" or \"run down\" (i.e., an ascending or a descending run of length >= 2) is called \"s\u00e9quence\" by Andr\u00e9 (19th century) and Comtet (1974). See the references for sequence A000708 or for array A059427. (Again, recall that David and Barton do not consider single numbers as either a \"run up\" or a \"run down\".)", "Morley (1897) proved that in a permutation of [n], #(\"runs up\") + #(\"runs down\") + #(monotonic triplets of adjacent numbers in the permutation) = n - 1. (His definition of a run is highly non-standard!) See the example below.", "The number Q(n,k) of circular permutations of [n] that contain k runs that are either \"runs up\" or \"runs down\" (that is, k ascending or descending runs of length >= 2) is given by array A008303. More precisely, Q(n+1, 2*(k+1)) = A008303(n, k) for n >= 1 and 0 <= k <= ceiling(n/2)-1. In addition, Q(n, s) = 0 when either s is odd, or n <= 1, or s > n. Also, Q_{n,2} = 2^(n-2) for n >= 2.", "The numbers in array A008303 appear in Table 10.6 (p. 163) in David and Barton (1962).", "(End)"], "reference": ["Ch. A. Charalambides, Enumerative Combinatorics, Chapman & Hall/CRC, Boca Raton, Florida, 2002.", "F. N. David and D. E. Barton, Combinatorial Chance, Charles Griffin, 1962; see Table 10.5, p. 163.", "F. N. David, M. G. Kendall and D. E. Barton, Symmetric Function and Allied Tables, Cambridge, 1966, p. 260."], "link": ["Alois P. Heinz, <a href=\"/A008971/b008971.txt\">Rows n = 0..170, flattened</a>", "David Callan, Shi-Mei Ma, and Toufik Mansour, <a href=\"http://www.combinatorics.org/ojs/index.php/eljc/article/view/v22i2p22/\">Some Combinatorial Arrays Related to the Lotka-Volterra System</a>, Electronic Journal of Combinatorics, Volume 22, Issue 2 (2015), Paper #P2.22.", "C.-O. Chow and S.-M. Ma, <a href=\"http://dx.doi.org/10.1016/j.disc.2014.01.015\">Counting signed permutations by their alternating runs</a>, Discrete Mathematics, Volume 323, 28 May 2014, Pages 49-57.", "C.-O. Chow, S.-M. Ma, T. Mansour, and M. Shattuck, <a href=\"http://ami.ektf.hu/uploads/papers/finalpdf/AMI_43_from43to54.pdf\">Counting permutations by cyclic peaks and valleys</a>, Annales Mathematicae et Informaticae, (2014), Vol. 43, pp. 43-54.", "FindStat - Combinatorial Statistic Finder, <a href=\"http://www.findstat.org/StatisticsDatabase/St000035/\">The number of outer peaks of a permutation</a>", "Amy M. Fu, <a href=\"https://arxiv.org/abs/1801.04397\">A Context-free Grammar for Peaks and Double Descents of Permutations</a>, arXiv:1801.04397 [math.CO], 2018.", "Amy M. Fu and Frank Z. K. Li, <a href=\"https://arxiv.org/abs/1809.07465\">Joint Distributions of Permutation Statistics and the Parabolic Cylinder Functions</a>, arXiv:1809.07465 [math.CO], 2018.", "D. S. Hollman and H. F. Schaefer III, <a href=\"http://dx.doi.org/10.1063/1.4759170\">Arbitrary order El'yashevich-Wilson B tensor formulas for the most frequently used internal coordinates in molecular vibrational analyses</a>, The Journal of Chemical Physics, Vol. 137, 164103 (2012). - From _N. J. A. Sloane_, Jan 01 2013", "Shi-Mei Ma, <a href=\"http://arxiv.org/abs/1106.5781\">Derivative polynomials and permutations by numbers of interior peaks and left peaks</a>, arXiv preprint arXiv:1106.5781 [math.CO], 2011.", "Shi-Mei Ma, <a href=\"http://dx.doi.org/10.1016/j.disc.2013.05.010\">Enumeration of permutations by number of alternating runs</a>, Discrete Math., 313 (2013), 1816-1822.", "Shi-Mei Ma, Qi Fang, Toufik Mansour, Yeong-Nan Yeh, <a href=\"https://arxiv.org/abs/2104.09374\">Alternating Eulerian polynomials and left peak polynomials</a>, arXiv:2104.09374, 2021", "Shi-Mei Ma, T. Mansour, and D. Callan, <a href=\"http://arxiv.org/abs/1404.0731\">Some combinatorial arrays related to the Lotka-Volterra system</a>, arXiv preprint arXiv:1404.0731 [math.CO], 2014.", "S.-M. Ma, T. Mansour and D. G. L. Wang, <a href=\"http://arxiv.org/abs/1403.0233\">Combinatorics of Dumont differential system on the Jacobi elliptic functions</a>, arXiv preprint arXiv:1403.0233 [math.CO], 2014.", "Shi-Mei Ma, Toufik Mansour, David G.L. Wang, and Yeong-Nan Yeh, <a href=\"https://www.math.sinica.edu.tw/www/file_upload/mayeh/2018SCM-2016-0688.pdf\">Several variants of the Dumont differential system and permutation statistics</a>, Science China Mathematics 60 (2018).", "Shi-Mei Ma, Jun Ma, Jean Yeh, Yeong-Nan Yeh, <a href=\"https://arxiv.org/abs/2001.07833\">The 1/k-Eulerian polynomials of type B</a>, arXiv:2001.07833 [math.CO], 2020.", "Shi-Mei Ma and Yeong-Nan Yeh, <a href=\"http://www.combinatorics.org/ojs/index.php/eljc/article/view/v23i2p14\">The Peak Statistics on Simsun Permutations</a>, Elect. J. Combin., 23 (2016), P2.14; <a href=\"https://arxiv.org/abs/1601.06505\">arXiv preprint</a>, arXiv:1601.06505 [math.CO], 2016.", "F. Morley, <a href=\"http://dx.doi.org/10.1090/S0002-9904-1897-00451-7\">A generating function for the number of permutations with an assigned number of sequences</a>, Bull. Amer. Math. Soc. 4 (1897), 23-28.", "L. W. Shapiro, W.-J. Woan, and S. Getu, <a href=\"http://dx.doi.org/10.1137/0604046\">Runs, slides and moments</a>, SIAM J. Alg. Discrete Methods, 4 (1983), 459-466.", "Wikipedia, <a href=\"https://en.wikipedia.org/wiki/Florence_Nightingale_David\">Florence Nightingale David.", "Bao-Xuan Zhu, <a href=\"https://arxiv.org/abs/2007.14924\">Stieltjes moment properties and continued fractions from combinatorial triangles</a>, arXiv:2007.14924 [math.CO], 2020, see p. 27.", "Yan Zhuang, <a href=\"http://arxiv.org/abs/1505.02308\">Monoid networks and counting permutations by runs</a>, arXiv preprint arXiv:1505.02308 [math.CO], 2015."], "formula": ["E.g.f.: G(t,x) = sum(T(n,k) t^k x^n/n!, 0<=k<=floor(n/2), n>=0) = sqrt(1-t)/(sqrt(1-t)*cosh(x*sqrt(1-t))-sinh(x*sqrt(1-t))) (_Ira M. Gessel_).", "T(n+1,k) = (2*k+1)*T(n,k) + (n-2*k+2)*T(n,k-1) (see p. 542 of the Charalambides reference or p. 163 in the David and Barton book).", "G.f.: T(0)/(1-x), where T(k) = 1 - y*x^2*(k+1)^2/(y*x^2*(k+1)^2 - (1 -x -2*x*k)*(1 -3*x -2*x*k)/T(k+1) ); (continued fraction). - _Sergei N. Gladkovskii_, Nov 08 2013", "From _Peter Bala_, Jan 23 2016: (Start)", "cos(x)^(n+1)*(d/dx)^n(1/cos(x)) = Sum_{k = 0..floor(n/2)} T(n,k)*sin(x)^(n-2*k).", "Equivalently, let D be the differential operator sqrt(1 - x^2)*d/dx. Then sqrt(1 - x^2)^(n+1)*D^n(1/sqrt(1 - x^2)) = Sum_{k = 0..floor(n/2)} T(n,k)*x^(n-2*k). (End)"], "example": ["Triangle T(n,k) (with rows n >= 0 and columns k >= 0) starts as follows:", "  1;", "  1;", "  1,   1;", "  1,   5;", "  1,  18,       5;", "  1,  58,      61;", "  1, 179,     479,     61;", "  1, 543,    3111,   1385;", "  1, 1636,  18270,  19028,  1385;", "  1, 4916, 101166, 206276, 50521;", "  ...", "Example: T(3,1) = 5 because all permutations of [3] with the exception of 321 have one increasing run of length at least 2.", "From _Peter Bala_, Jan 23 2016: (Start)", "Row 6: cos(x)^7*(d/dx)^6(1/cos(x)) = sin(x)^6 + 179*sin(x)^4 + 479*sin(x)^2 + 61.", "Equivalently, (sqrt(1 - x^2))^7*D^6(1/sqrt(1 - x^2)) = x^6 + 179*x^4 + 479*x^2 + 61, where D = sqrt(1 - x^2)*d/dx. (End)", "From _Petros Hadjicostas_, Aug 09 2019: (Start)", "Consider the permutations of [4]. We list the increasing runs of length at least 2 (= \"runs up\"), the decreasing runs of length at least 2 (= \"runs down\"), and the monotonic triplets of adjacent numbers in the permutation (which we abbreviate to MTAN for simplicity). The sum of the numbers of these three should be n-1 (see Morley (1897) but notice that his use of the word \"run\" is highly non-standard).", "1234 -> \"runs up\" = {1234}, \"runs down\" = {}, MTAN = {123, 234}.", "1243 -> \"runs up\" = {124}, \"runs down\" = {43}, MTAN = {124}.", "1324 -> \"runs up\" = {13, 24}, \"runs down\" = {32}, MTAN = {}.", "1342 -> \"runs up\" = {134}, \"runs down\" = {42}, MTAN = {134}.", "1423 -> \"runs up\" = {14, 23}, \"runs down\" = {42}, MTAN = {}.", "1432 -> \"runs up\" = {14}, \"runs down\" = {432}, MTAN = {432}.", "2134 -> \"runs up\" = {134}, \"runs down\" = {21}, MTAN = {134}.", "2143 -> \"runs up\" = {14}, \"runs down\" = {21, 43}, MTAN = {}.", "2314 -> \"runs up\" = {23, 14}, \"runs down\" = {31}, MTAN = {}.", "2341 -> \"runs up\" = {234}, \"runs down\" = {41}, MTAN = {234}.", "2413 -> \"runs up\" = {24, 13}, \"runs down\" = {41}, MTAN = {}.", "2431 -> \"runs up\" = {24}, \"runs down\" = {431}, MTAN = {431}.", "3124 -> \"runs up\" = {124}, \"runs down\" = {31}, MTAN = {124}.", "3142 -> \"runs up\" = {14}, \"runs down\" = {31, 42}, MTAN = {}.", "3214 -> \"runs up\" = {14}, \"runs down\" = {321}, MTAN = {321}.", "3241 -> \"runs up\" = {24}, \"runs down\" = {32, 41}, MTAN = {}.", "3412 -> \"runs up\" = {34, 12}, \"runs down\" = {41}, MTAN = {}.", "3421 -> \"runs up\" = {34}, \"runs down\" = {421}, MTAN = {421}.", "4123 -> \"runs up\" = {123}, \"runs down\" = {41}, MTAN = {123}.", "4132 -> \"runs up\" = {13}, \"runs down\" = {41, 32}, MTAN = {}.", "4213 -> \"runs up\" = {13}, \"runs down\" = {421}, MTAN = {421}.", "4231 -> \"runs up\" = {23}, \"runs down\" = {42, 31}, MTAN = {}.", "4312 -> \"runs up\" = {12}, \"runs down\" = {431}, MTAN = {431}.", "4321 -> \"runs up\" = {}, \"runs down\" = {4321}, MTAN = {432, 321}.", "If we let k = number of increasing runs of length >= 2 (= number of \"runs up\") in a permutation of [4], then (from above) the possible values of k are 0, 1, 2, and we have T(n=4, k=0) = 1, T(n=4, k=1) = 18, and T(n=4, k=2) = 5.", "If we let k = number of decreasing runs of length >= 2 (= number of \"runs down\") in a permutation of [4], then again the possible values of k are 0, 1, 2, and we have T(n=4, k=0) = 1, T(n=4, k=1) = 18, and T(n=4, k=2) = 5.", "Finally, note that if b_i, b_{i+1}, b_{i+2} is an increasing triplet of adjacent numbers in permutation b, then n+1-b_i, n+1-b_{i+1}, n+1-b_{i+2} is a decreasing triplet of adjacent numbers in the complement of b, and vice versa. For example, 4213 is the complement of 1342. Their set of monotonic triplets of adjacent numbers are {421} and {134}, respectively, and we have 4 + 1 = 2 + 3 = 1 + 4 = 5.", "(End)"], "maple": ["G:=sqrt(1-t)/(sqrt(1-t)*cosh(x*sqrt(1-t))-sinh(x*sqrt(1-t))): Gser:=simplify(series(G,x=0,15)): for n from 0 to 14 do P[n]:=sort(expand(n!*coeff(Gser,x,n))) od: seq(seq(coeff(t*P[n],t^k),k=1..1+floor(n/2)),n=0..14); # edited by _Johannes W. Meijer_, May 15 2009", "# second Maple program:", "T:= proc(n, k) option remember; `if`(k=0, 1, `if`(k>iquo(n, 2), 0,", "      (2*k+1)*T(n-1, k) +(n+1-2*k)*T(n-1, k-1)))", "    end:", "seq(seq(T(n, k), k=0..n/2), n=0..14); # _Alois P. Heinz_, Oct 16 2013"], "mathematica": ["t[n_, 0] = 1; t[n_, k_] /; k > Floor[n/2] = 0;", "t[n_ , k_ ] /; k <= Floor[n/2] := t[n, k] = (2 k + 1) t[n - 1, k] + (n - 2 k + 1) t[n - 1, k - 1];", "Flatten[Table[t[n, k], {n, 0, 12}, {k, 0, Floor[n/2]}]][[1 ;; 45]] (* _Jean-Fran\u00e7ois Alcover_, May 30 2011, after given formula *)"], "xref": ["A160486 is a sub-triangle.", "A000340, A000363, A000507 equal the second, third and fourth left hand columns.", "Cf. A000708, A008303, A008970, A059427.", "T(2n,n) gives A000364."], "keyword": "tabf,nonn,easy", "offset": "0,6", "author": "_N. J. A. Sloane_", "ext": ["Edited by _Emeric Deutsch_ and _Ira M. Gessel_, Aug 28 2004", "Crossrefs added by _Johannes W. Meijer_, May 24 2009"], "references": 4, "revision": 142, "time": "2021-04-21T08:02:50-04:00", "created": "1996-03-15T03:00:00-05:00"}]}