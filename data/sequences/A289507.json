{"greeting": "Greetings from The On-Line Encyclopedia of Integer Sequences! http://oeis.org/", "query": "id:A289507", "count": 1, "start": 0, "results": [{"number": 289507, "data": "0,1,2,2,3,5,4,3,4,10,5,6,6,17,13,4,7,9,8,11,10,26,9,7,6,37,6,18,10,14,11,5,29,50,25,10,12,65,20,12,13,21,14,27,17,82,15,8,8,19,53,38,16,13,34,19,34,101,17,15,18,122,12,6,15,30,19,51", "name": "The sum of squares of the elements of a finite multiset of positive integers divided by their gcd, the multiset {s_j} being indexed by n = Product_j p_{s_j}, where p_{s_j} is the s_j-th prime.", "comment": ["Given an integer linear equation Sum_{j=1..k} e_j x_j = 0, a(n) is also the modulus of the determinant whose first row is e_1, e_2, ..., e_k and whose other k-1 rows form an integral basis for the integer solution space of the equation. Here n = Product_j p_{e_j}, where p_{e_j} is the e_j-th prime.", "For the proof, see Links.", "Also a(n) = A289506(n) when gcd_j e_j = 1, which occurs for the numbers n in A289509."], "link": ["Alois P. Heinz, <a href=\"/A289507/b289507.txt\">Table of n, a(n) for n = 1..20000</a>", "Christopher J. Smyth, <a href=\"/A289507/a289507.pdf\">A determinant associated to an integer linear equation</a>"], "formula": ["a(n) = (Sum_j e_j^2)/gcd_j(e_j), where n = Product_j p_{e_j}."], "example": ["For n = 63 = 3^2*7 = p_2*p_2*p_4, the corresponding multiset is {2,2,4}, and a(63) = (2^2 + 2^2 + 4^2)/2 = 12. Also the relevant determinant is Det([[2,2,4],[-1,1,0],[-2,0,1]]) = 12."], "maple": ["p:=1: for ind to 1000 do p:=nextprime(p); primeindex[p]:=ind; od:", "# so primeindex[p]:=k if p is the k-th prime", "out:=[0]: for n from 2 to 100 do f:=ifactors(n)[2];", "m:=[];g:=0; for k to nops(f) do pow:=f[k]; ind:=primeindex[pow[1]];g:=gcd(g,ind); for e to pow[2] do", "m:=[op(m), ind]; od; od; out:=[op(out), sum(m[jj]^2, jj=1..nops(m))/g];", "od:print(out);", "# second Maple program:", "with(numtheory):", "a:= n-> (l-> add(i[1]^2*i[2], i=l)/`if`(n=1, 1, igcd(seq(i[1],", "         i=l))))(map(i-> [pi(i[1]), i[2]], ifactors(n)[2])):", "seq(a(n), n=1..80);  # _Alois P. Heinz_, Aug 05 2017"], "mathematica": ["a[n_] := Module[{m}, m = Table[{p, e} = pe; Table[PrimePi[p], {e}], {pe, FactorInteger[n]}] // Flatten; (m.m)/GCD @@ m]; a[1] = 0; Array[a, 80] (* _Jean-Fran\u00e7ois Alcover_, May 05 2019 *)"], "program": ["(PARI) a(n) = if (n==1, 0, my(f=factor(n)); sum(k=1, #f~, f[k,2]*primepi(f[k,1])^2) /gcd(apply(x->primepi(x), f[,1]))); \\\\ _Michel Marcus_, Jul 19 2017"], "xref": ["Cf. A289506, A289509.", "Cf. A056239, where the same encoding for integer multisets ('Heinz encoding') is used."], "keyword": "nonn,look", "offset": "1,3", "author": "_Christopher J. Smyth_, Jul 07 2017", "references": 13, "revision": 24, "time": "2019-05-05T16:00:04-04:00", "created": "2017-08-02T11:35:23-04:00"}]}