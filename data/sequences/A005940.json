{"greeting": "Greetings from The On-Line Encyclopedia of Integer Sequences! http://oeis.org/", "query": "id:A005940", "count": 1, "start": 0, "results": [{"number": 5940, "id": "M0509", "data": "1,2,3,4,5,6,9,8,7,10,15,12,25,18,27,16,11,14,21,20,35,30,45,24,49,50,75,36,125,54,81,32,13,22,33,28,55,42,63,40,77,70,105,60,175,90,135,48,121,98,147,100,245,150,225,72,343,250,375,108,625,162,243,64,17,26,39", "name": "The Doudna sequence: write n-1 in binary; power of p_k in a(n) is # of 1's that are followed by k-1 0's.", "comment": ["A permutation of the natural numbers. - _Robert G. Wilson v_, Feb 22 2005", "Fixed points: A029747. - _Reinhard Zumkeller_, Aug 23 2006", "The even bisection, when halved, gives the sequence back. - _Antti Karttunen_, Jun 28 2014", "From _Antti Karttunen_, Dec 21 2014: (Start)", "This irregular table can be represented as a binary tree. Each child to the left is obtained by applying A003961 to the parent, and each child to the right is obtained by doubling the parent:", "                                      1", "                                      |", "                   ...................2...................", "                  3                                       4", "        5......../ \\........6                   9......../ \\........8", "       / \\                 / \\                 / \\                 / \\", "      /   \\               /   \\               /   \\               /   \\", "     /     \\             /     \\             /     \\             /     \\", "    7       10         15       12         25       18         27       16", "  11 14   21  20     35  30   45  24     49  50   75  36    125  54   81  32", "etc.", "Sequence A163511 is obtained by scanning the same tree level by level, from right to left. Also in binary trees A253563 and A253565 the terms on level of the tree are some permutation of the terms present on the level n of this tree. A252464(n) gives the distance of n from 1 in all these trees.", "A252737(n) gives the sum and A252738(n) the product of terms on row n (where 1 is on row 0, 1 on row 1, 3 and 4 on row 2, etc.). A252745(n) gives the number of nodes on level n whose left child is larger than the right child, A252750 the difference between left and right child for each node from node 2 onward.", "(End)", "-A008836(a(1+n)) gives the corresponding numerator for A323505(n). - _Antti Karttunen_, Jan 19 2019", "(a(2n+1)-1)/2 [= A244154(n)-1, for n >= 0] is a permutation of the natural numbers. - _George Beck_ and _Antti Karttunen_, Dec 08 2019", "From _Peter Munn_, Oct 04 2020: (Start)", "Each term has the same even part (equivalently, the same 2-adic valuation) as its index.", "Using the tree depicted in Antti Karttunen's 2014 comment:", "Numbers are on the right branch (4 and descendants) if and only if divisible by the square of their largest prime factor (cf. A070003).", "Numbers on the left branch, together with 2, are listed in A102750.", "(End)"], "reference": ["N. J. A. Sloane and Simon Plouffe, The Encyclopedia of Integer Sequences, Academic Press, 1995 (includes this sequence)."], "link": ["A. Karttunen & R. Zumkeller (first 1024 terms), <a href=\"/A005940/b005940.txt\">Table of n, a(n) for n = 1..8192</a>", "R. E. Kutz, <a href=\"http://www.jstor.org/stable/3027304\">Two unusual sequences</a>, Two-Year College Mathematics Journal, 12 (1981), 316-319.", "Michael De Vlieger, 6 row <a href=\"/A005940/a005940.png\">Doudna Tree diagram</a> as mentioned in Comments.", "Michael De Vlieger, <a href=\"/A005940/a005940_1.png\">Doudna Tree diagram</a> showing 8 rows.", "<a href=\"/index/Per#IntegerPermutation\">Index entries for sequences that are permutations of the natural numbers</a>"], "formula": ["a(n) = f(n-1, 1, 1) with f(n, i, x) = if n=0 then x = else (if n mod 2 = 0 then f(n/2, i+1, x) else f((n-1)/2, i, x*prime(i))). - _Reinhard Zumkeller_, Aug 23 2006, _R. J. Mathar_, Mar 06 2010", "From _Antti Karttunen_, Jun 26 2014: (Start)", "Define a starting-offset 0 version of this sequence as:", "b(0)=1, b(1)=2, [base cases]", "and then compute the rest either with recurrence:", "b(n) = A000040(1+(A070939(n)-A000120(n))) * b(A053645(n)).", "or", "b(2n) = A003961(b(n)), b(2n+1) = 2 * b(n). [Compare this to the similar recurrence given for A163511].", "Then define a(n) = b(n-1), where a(n) gives this sequence A005940 with the starting offset 1.", "Can be also defined as a composition of related permutations:", "a(n+1) = A243353(A006068(n)).", "a(n+1) = A163511(A054429(n)). [Compare the scatter plots of this sequence and A163511 to each other].", "This permutation also maps between the partitions as enumerated in the lists A125106 and A112798, providing identities between:", "A161511(n) = A056239(a(n+1)). [The corresponding sums]", "A243499(n) = A003963(a(n+1)). [... and the products of parts of those partitions].", "(End)", "From _Antti Karttunen_, Dec 21 2014  - Jan 04 2015: (Start)", "A002110(n) =  a(1+A002450(n)). [Primorials occur at (4^n - 1)/3 in the offset-0 version of the sequence.]", "a(n) = A250246(A252753(n-1)).", "a(n) = A122111(A253563(n-1)).", "For n >= 1, A055396(a(n+1)) = A001511(n).", "For n >= 2, a(n) = A246278(1+A253552(n)).", "(End)", "From _Peter Munn_, Oct 04 2020: (Start)", "A000265(a(n)) = a(A000265(n)) = A003961(a(A003602(n))).", "A006519(a(n)) = a(A006519(n)) = A006519(n).", "a(n) = A003961(a(A003602(n))) * A006519(n).", "A007814(a(n)) = A007814(n).", "A007949(a(n)) = A337821(n) = A007814(A003602(n)).", "a(n) = A225546(A334866(n-1)).", "(End)"], "maple": ["f := proc(n,i,x) option remember ; if n = 0 then x; elif type(n,'even') then procname(n/2,i+1,x) ; else procname((n-1)/2,i,x*ithprime(i)) ; end if; end proc:", "A005940 := proc(n) f(n-1,1,1) ; end proc: # _R. J. Mathar_, Mar 06 2010"], "mathematica": ["f[n_] := Block[{p = Partition[ Split[ Join[ IntegerDigits[n - 1, 2], {2}]], 2]}, Times @@ Flatten[ Table[q = Take[p, -i]; Prime[ Count[ Flatten[q], 0] + 1]^q[[1, 1]], {i, Length[p]}] ]]; Table[ f[n], {n, 67}] (* _Robert G. Wilson v_, Feb 22 2005 *)"], "program": ["(PARI) A005940(n) = { my(p=2, t=1); n--; until(!n\\=2, n%2 && (t*=p) || p=nextprime(p+1)); t } \\\\ _M. F. Hasler_, Mar 07 2010; update Aug 29 2014", "(Haskell)", "a005940 n = f (n - 1) 1 1 where", "   f 0 y _          = y", "   f x y i | m == 0 = f x' y (i + 1)", "           | m == 1 = f x' (y * a000040 i) i", "           where (x',m) = divMod x 2", "-- _Reinhard Zumkeller_, Oct 03 2012", "(Scheme, with memoization-macro definec from Antti Karttunen's IntSeq-library)", "(define (A005940 n) (A005940off0 (- n 1))) ;; The off=1 version, utilizing any one of three different offset-0 implementations:", "(definec (A005940off0 n) (cond ((< n 2) (+ 1 n)) (else (* (A000040 (- (A070939 n) (- (A000120 n) 1))) (A005940off0 (A053645 n))))))", "(definec (A005940off0 n) (cond ((<= n 2) (+ 1 n)) ((even? n) (A003961 (A005940off0 (/ n 2)))) (else (* 2 (A005940off0 (/ (- n 1) 2))))))", "(define (A005940off0 n) (let loop ((n n) (i 1) (x 1)) (cond ((zero? n) x) ((even? n) (loop (/ n 2) (+ i 1) x)) (else (loop (/ (- n 1) 2) i (* x (A000040 i)))))))", ";; _Antti Karttunen_, Jun 26 2014", "(Python)", "from sympy import prime", "import math", "def A(n): return n - 2**int(math.floor(math.log(n, 2)))", "def b(n): return n + 1 if n<2 else prime(1 + (len(bin(n)[2:]) - bin(n)[2:].count(\"1\"))) * b(A(n))", "print([b(n - 1) for n in range(1, 101)]) # _Indranil Ghosh_, Apr 10 2017"], "xref": ["Cf. A103969. Inverse is A005941 (A156552).", "Cf. A125106. [From _Franklin T. Adams-Watters_, Mar 06 2010]", "Cf. A252737 (gives row sums), A252738 (row products), A332979 (largest on row).", "Related permutations of positive integers: A163511 (via A054429), A243353 (via A006068), A244154, A253563 (via A122111), A253565, A332977, A334866 (via A225546).", "A000120, A003602, A003961, A006519, A053645, A070939, A246278, A250246, A252753, A253552 are used in a formula defining this sequence.", "Formulas for f(a(n)) are given for f = A000265, A003963, A007949, A055396, A056239.", "Numbers that occur at notable sets of positions in the binary tree representation of the sequence: A000040, A000079, A002110, A070003, A070826, A102750.", "Cf. also A000142, A001511, A002450, A112798, A252463, A252464, A252745, A252750, A324054, A324106, A323505, A323508.", "Cf. A106737, A290077, A323915, A324052, A324054, A324055, A324056, A324057, A324058, A324114, A324335, A324340, A324348, A324349 for various number-theoretical sequences applied to (i.e., permuted by) this sequence.", "k-adic valuation: A007814 (k=2), A337821 (k=3).", "Positions of multiples of 3: A091067.", "Primorial deflation: A337376 / A337377."], "keyword": "nonn,easy,nice,tabf,look,changed", "offset": "1,2", "author": "_N. J. A. Sloane_ and _J. H. Conway_", "ext": ["More terms from _Robert G. Wilson v_, Feb 22 2005", "Sign in a formula switched and Maple program added by _R. J. Mathar_, Mar 06 2010", "Binary tree illustration and keyword tabf added by _Antti Karttunen_, Dec 21 2014"], "references": 306, "revision": 136, "time": "2021-05-14T02:55:49-04:00", "created": "1991-07-11T03:00:00-04:00"}]}